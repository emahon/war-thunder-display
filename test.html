<!DOCTYPE html>
<html>
<head>
    <title>Display</title>
<style>
</style>

</head>
<body>

<script>
// globals
let data = [];
let state = [];
var counter = 0;

let g = 9.8; // constant for gravity, TODO: What does Gaijin actually use?

setInterval(function () {
  fetch("http://localhost:8111/indicators")
    .then(response => response.json())
    .then(json => {
      data = json;
	  calc_energy(data, state);
    })
}, 50);

setInterval(function () {
  fetch("http://localhost:8111/state")
    .then(response => response.json())
    .then(json => {
	 state = json;
	 calc_energy(data, state);
    })
}, 50);

function calc_energy(data, state) {
  let energy_speed = (data.speed**2/2);
  let energy_height = (g*state["H, m"]);
  let energy = energy_speed + energy_height;
  document.getElementById("energy_speed").innerText = energy_speed;
  document.getElementById("energy_height").innerText = energy_height;
  document.getElementById("energy").innerText = energy;
}
</script>
<div id="main">
  Specific Energy from Speed = <span id="energy_speed"></span> J/kg <br />
  Specific Energy from Altitude = <span id="energy_height"></span> J/kg <br />
  Specific Energy = <span id="energy"></span> J/kg
</div>
</body>
</html>